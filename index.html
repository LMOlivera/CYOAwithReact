<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!---------------------- -->
    <!--  React.js and Babel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.3.1/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.3.1/react-dom.js"></script>
    <!---------------------- -->
    <link rel="stylesheet" href="style.css"></link>
    <title>Choose Your Own Adventure! featuring React.js</title>
  </head>
  <body>
    <header>
      CYOA Test
    </header>
    <div id="container"><section>If you can read this, it means React is failing.</section></div>
    <footer>
      Lucas Olivera 2018
    </footer>
	  <script type="text/babel">
	  	//Only displays inventory, nothing else.
class Inventory extends React.Component{
  constructor(props){
    super(props)
    this.state={
      inventory: props.inventory.map(function(item){
                        return <center><button>{item}</button></center>;
                      })
    }
  }
  
  render(){
    const inv = <center><ul id="inventory">{this.state.inventory}</ul></center>;
    const invEmpty = <center><p>You have no items</p></center>;
    return(
      this.state.inventory==[] ? inv : invEmpty
    )
  }
}


class ChapterOne extends React.Component{
  constructor(props){
    super(props);
  }
  
  render(){
    const part0 = <div>
                    <p>This is a test. It was programmed just to see if everything is going to be okay. What do you think?</p>
                  </div>;
    const question0 = <div><button onClick={() => this.props.addChoice('1')}>Everything will go as planned</button>   <button onClick={() => this.props.addChoice('0')}>I think you can't do anything right</button></div>;
    const part1Good = <p>Thanks, I appreciate that.</p>;
    const part1Bad = <p>That was very rude, you know.</p>;
    
    const part1 = <div>
                    Anyways, if this works that means it should be a good idea to start writting some plot to make a good, interactive story.                    
                  </div>;
    
    return(
      <p>
        {part0}
        {this.props.progress==0 && question0}
        {this.props.progress>=1 && (this.props.choices[0]>=1 ? <b>Everything will go as planned</b> : <p>I think you can't do <b>anything</b> right</p>)}
        {this.props.progress>=1 && (this.props.choices[0]==1 ? part1Good : part1Bad)}
        {this.props.progress>=1 && part1}
      </p>      
    )
  }
}

class ChapterTwo extends React.Component{
  constructor(props){
    super(props);
  }
  
  render(){
    const part0 = <div>
                    <p>Everything works, just inventory and some style left!</p>
                  </div>;
    const question0 = <div><button onClick={() => this.props.addChoice('1')}>Everything will go as planned</button>   <button onClick={() => this.props.addChoice('0')}>I think you can't do anything right</button></div>;
    const part1Good = <p>Thanks, I appreciate that.</p>;
    const part1Bad = <p>That was very rude, you know.</p>;
    
    const part1 = <div>
                    Anyways, if this works that means it should be a good idea to start writting some plot to make a good, interactive story.                    
                  </div>;
    
    return(
      <p>
        {part0}
      </p>      
    )
  }
}


//Contains the story chapters
class Story extends React.Component{
  constructor(props){
    super(props);
    this.state={
      inventory: [],
      /* INDEX OF CHOICES:
      0: First
      
      */
      choices: [],
      chapter: 0,
      progress: 0
    }
    this.addChoice = this.addChoice.bind(this);
  }
  
  addChoice(choiceMade){
    let cho = this.state.choices;
    cho.push(choiceMade)
    this.setState({choices: cho, progress: this.state.progress+1});
  }
  
  render(){
    if(this.state.progress>=0 & this.state.progress<=0){
       return(
         <main>
           <nav>
             <Inventory inventory={this.state.inventory}/>
           </nav>
           <section>
             <ChapterOne addChoice={this.addChoice.bind(this)} progress={this.state.progress} choices={this.state.choices}/>
           </section>
         </main>
       );
    }
    else if(this.state.progress>=1 & this.state.progress<=2){
      return(
      <main>
        <nav>
          <Inventory inventory={this.state.inventory}/>
        </nav> 
        <section>
          <ChapterTwo addChoice={this.addChoice.bind(this)} progress={this.state.progress} choices={this.state.choices}/>
        </section>
      </main>
    )
    }
  }
}

ReactDOM.render(<Story />, document.getElementById('container'));	  
	  </script>	
  </body>
</html>
